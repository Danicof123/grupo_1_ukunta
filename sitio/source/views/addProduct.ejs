<!DOCTYPE html>
<html lang="es">
<%- include('partials/head') %>

   <body class="register f-display f-main-y minvh-100">
      <%- include('partials/mini-header') %>

         <div class="container f-main-center f-grow-1">
            <div class="mb-12 lp-6 f-main-y f-cross-center">
               <h3 class="my-4 f-center">Añadir producto</h3>

               <!-- Error en formulario -->
               <label id="error-form" class="text-danger"></label>

               <!-- Formulario de carga de producto -->
               <form id="form-addProduct" class="w-100 mbt-4 form-addProduct" action="/store" method="POST" enctype="multipart/form-data">
                  
                  <!-- Nombre -->
                  <label for="name" class="reg__date__age">Ingrese el nombre del producto:</label>
                  <div class="reg__ctrl-input mbt-4">
                     <!-- Error back -->
                     <% if (locals.errors && errors.name) { %>
                        <div class="text-danger">
                           <%= errors.name.msg %>
                        </div>
                     <% } %>
                     <!-- Input -->
                        <input id="form-name" type="text" placeholder="*Nombre" name="name" class="reg__input" value="<%= locals.old ? old.name : null %>" pattern="^[A-Za-zñÑáÁéÉiÍóÓúüÚÜ]{2,45}(\s+[A-Za-zñÑáÁéÉiÍóÓúüÚÜ]{2,45}){0,2}$" title="Debe ingresar el nombre del producto." required />
                  </div>

                  <!-- Categoria -->
                  <label for="category" class="reg__date__age">Elija la categoria:</label>
                  <div class="reg__ctrl-input mbt-4">
                        <!-- Error back -->
                        <% if (locals.errors && errors.category) { %>
                        <div class="text-danger">
                           <%= errors.category.msg %>
                        </div>
                        <% } %>
                        
                        <!-- Options -->
                        <select id="form-category" name="category" class="reg__input" pattern="^[1-3]$" title="Debes seleccionar una categoría." required>
                           <option value="" selected hidden>*Categoria</option>
                           <% categories.forEach(category => { %>
                           <option value="<%= category.id %>" <%= locals.old && old.category.id === category.id ? "selected" : null%> ><%= category.name %></option>
                           <% }) %>
                        </select>
                  </div>

                  <!-- Descripcion producto -->
                  <label for="description" class="reg__date__age">Ingrese la descripción:</label>
                  <div class="reg__ctrl-textarea mbt-4">
                     <!-- Error back -->
                     <% if (locals.errors && errors.description) { %>
                        <div class="text-danger">
                           <%= errors.description.msg %>
                        </div>
                     <% } %>
   
                     <!-- Text area -->
                        <textarea id="form-description" name="description" class="text__area" placeholder="*Descripción del producto" data-pattern="^.{10,255}$" title="La descripción debe tener un minimo de 10 carácteres y un máximo de 255." required><%= locals.old ? old.description : null %></textarea>
                  </div>

                  <!-- Tamaño -->
                  <label for="size" class="reg__date__age">Ingrese el tamaño o volumen:</label>
                  <div class="reg__ctrl-input mbt-4">
                     <!-- Error back -->
                     <% if (locals.errors && errors.size) { %>
                        <div class="text-danger">
                           <%= errors.size.msg %>
                        </div>
                     <% } %>
                     
                     <!-- Input -->
                        <input id="form-size" type="text" placeholder="*Tamaño o volumen del producto" name="size" class="reg__input" value="<%= locals.old ? old.size : null %>" pattern="^.{0,15}$" title="El tamaño o volumen del producto debe tener un máximo de 15 caracteres." required />
                  </div>

                  <!-- precio -->
                  <label for="price" class="reg__date__age">Ingrese el importe:</label>
                  <div class="reg__ctrl-input mbt-4">
                     <!-- Error back -->
                     <% if (locals.errors && errors.price) { %>
                        <div class="text-danger">
                           <%= errors.price.msg %>
                        </div>
                     <% } %>
                     
                     <!-- Input -->
                        <input id="form-price" type="number" placeholder="*Precio" class="reg__input" name="price"
                         value="<%= locals.old ? old.price : null %>" pattern="^\d*(\.\d{1})?\d{0,1}$" title="Debes ingresar el precio en formato número con un máximo de 2 decimales." required />
                  </div>

                  <!-- stock -->
                  <label for="stock" class="reg__date__age">Ingrese el stock:</label>
                  <div class="reg__ctrl-input mbt-4">
                     <!-- Error back -->
                     <% if (locals.errors && errors.stock) { %>
                        <div class="text-danger">
                           <%= errors.stock.msg %>
                        </div>
                     <% } %>
                     
                     <!-- Input -->
                     <input id="form-stock" name="stock" type="number" placeholder="*Stock" class="reg__input" name="stock" value="<%= locals.old ? old.stock : null %>" pattern="^[0-9]{1,4}$" title="Debes ingresar el stock con un máximo de 9999 unidades." required/>
                  </div>

                  <!-- Fecha de vencimiento -->
                  
                  <!-- Error back -->
                  <label for="expire" class="text-danger"><%= locals.errors && locals.errors.expire ? errors.expire.msg : null %></label>
                  <div class="row my-0 f-cross-center my-4">
                     <div class="mb-6">
                        <label for="expire" class="reg__date__age" >Fecha de vencimiento</label>
                     </div>
                     <!-- Input -->
                    <div class="mb-6">
                        <div class="reg__ctrl-input">
                            <input type="date" class="reg__input" name="expire" id="inp-date" value="<%= (locals && locals.errors) ? old.expire : null %>" pattern="^([12]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01]))$" title="Formato de fecha invalido." required>
                        </div>
                    </div>
                  </div>

                  <!-- Imagenes -->

                  <!-- Error back -->
                  <% if (locals.errors && errors.images) { %>
                     <div class="text-danger">
                        <%= errors.images.msg %>
                     </div>
                  <% } %>
                  <label for="images" class="reg__date__age">Seleccione hasta 5 imagenes:</label>
                  <!-- Input -->
                  <div class="reg__ctrl-input mbt-4">
                           <input id="form-image" type="file" accept=".jpg, .jpeg, .png" name="images" max="5" maxfile="5"
                              class="reg__input file__input" multiple />
                  </div>

                  <!-- Botones cruz y check -->

                  <div class="f-display f-main-between reg__navbottom f-cross-end mbt-5">
                     <a href="/store" class="no-decor">
                        <div class="button button-rojo reg__navbutton">
                           <i class="fas fa-times"></i>
                        </div>
                     </a>
                     <button type="submit" class="button button-verde reg__navbutton"><i
                           class="fas fa-check"></i></button>
                  </div>
               </form>
            </div>
         </div>
         <script src="/js/addProduct.js" type="module"></script>
   </body>

</html>